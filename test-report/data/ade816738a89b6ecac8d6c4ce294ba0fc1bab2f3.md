# Test info

- Name: Visual Regression - Chronische Schmerzen Page (Desktop) >> chronische-schmerzen-visual-desktop-fr
- Location: /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/ChronischeSchmerzen/ChronischeSchmerzenUITest.spec.ts:34:9

# Error details

```
Error: expect(received).toBeLessThanOrEqual(expected)

Expected: <= 0.7
Received:    4.411763735857818
    at VisualTestHelper.runVisualTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/visual-test-helper.ts:89:41)
    at MultiLanguageVisualHelper.runIndividualLanguageTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/multi-language-visual-helper.ts:56:5)
    at /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/ChronischeSchmerzen/ChronischeSchmerzenUITest.spec.ts:35:7
```

# Page snapshot

```yaml
- heading "🍪 Wir schätzen Ihre Privatsphäre" [level=1]
- paragraph: Wir verwenden Cookies, um Ihr Surferlebnis zu verbessern, personalisierte Anzeigen oder Inhalte einzusetzen und unseren Datenverkehr zu analysieren. Wenn Sie auf „Alle akzeptieren" klicken, stimmen Sie der Anwendung von Cookies zu.
- button "Anpassen"
- button "Alle akzeptieren"
- banner:
  - navigation:
    - link "DOLOMED_Logo_RGB_Claim 1":
      - /url: https://dolomed.ch/fr/
      - img "DOLOMED_Logo_RGB_Claim 1"
    - button "Open/Close Menu":
      - img
    - button "Français":
      - link "Français":
        - /url: "#"
        - img
        - text: Français
- 'heading "Soulager efficacement la douleur par neuromodulation : un traitement innovant de la douleur chronique" [level=1]':
  - text: "Soulager efficacement la douleur par neuromodulation : un"
  - strong: traitement
  - text: innovant
  - strong: de la douleur chronique
- paragraph: La neuromodulation/neurostimulation consiste à modifier l'activité du système nerveux à l'aide de la transmission d'impulsions électriques, ce qui permet de soulager les douleurs chroniques. Chez Dolomed, nous proposons différentes formes de neuromodulation afin d'offrir aux patients souffrant de douleurs difficiles à traiter un soulagement efficace et une meilleure qualité de vie.
- link "Prendre rendez-vous":
  - /url: "#"
- link "Appeler maintenant":
  - /url: tel:032 324 39 90
- img "Dolomed-Behandlung-von-chronischen-Hero-Illustrator-01-1-1-1"
- img "Dolomed-Bewegungsapparat-Arthrose-circle-light"
- img "Dolomed-Behandlung-von-chronischen-Zentrale-Illustrator-01-2048x2048"
- img "Dolomed-Bewegungsapparat-arthrose-circles-4"
- heading "Stimulation centrale de la moelle épinière versus stimulation périphérique des nerfs :" [level=2]
- list:
  - listitem:
    - strong: "Stimulation de la moelle épinière (Spinal Cord Stimulation) :"
    - text: Cette méthode utilise des impulsions électriques délivrées par des électrodes sur la moelle épinière pour bloquer les signaux de douleur. Pour ce faire, des électrodes sont implantées dans le canal rachidien et reliées à un générateur d'impulsions. Ce système de neurostimulation génère des impulsions électriques qui sont captées par la moelle épinière et transmises au cerveau.
  - listitem:
    - strong: "Stimulation nerveuse périphérique :"
    - text: des impulsions électriques sont envoyées directement aux nerfs périphériques afin de soulager la douleur. Les électrodes sont implantées directement sur le nerf sous contrôle échographique. Des impulsions électriques sont générées pour moduler le nerf et sa réponse à la douleur.
- heading "Déroulement de la thérapie par neurostimulation (stimulation de la moelle épinière / stimulation des nerfs périphériques)" [level=2]
- paragraph: "Une thérapie par neurostimulation chez Dolomed comprend plusieurs étapes qui garantissent que le traitement est efficace et sûr :"
- list:
  - listitem:
    - strong: "Antécédents médicaux et conseils :"
    - text: un entretien approfondi avec le médecin traitant afin de déterminer si la neuromodulation est appropriée.
  - listitem:
    - strong: "Traitement :"
    - text: avant d'envisager l'implantation d'une neurostimulation, il faut d'abord mettre en œuvre un traitement conservateur et interventionnel de la douleur. Si celle-ci ne donne pas les résultats escomptés, une demande de prise en charge peut être envoyée à la caisse d'assurance maladie et l'utilisation de la neurostimulation peut être planifiée.
  - listitem:
    - strong: "Stimulation test :"
    - text: un placement temporaire des électrodes pour tester l'efficacité de la stimulation. La stimulation se fait de l'extérieur, le générateur d'impulsions n'est pas encore implanté définitivement. Le plus souvent, ce traitement se fait en hospitalisation pendant 2 à 3 jours.
  - listitem:
    - strong: "Implantation :"
    - text: si la stimulation test est réussie, le système de neurostimulation est implanté de manière permanente. Cette implantation peut généralement se faire en ambulatoire.
  - listitem:
    - strong: "Suivi :"
    - text: visites de suivi régulières afin de surveiller le fonctionnement du système et de procéder à des ajustements.
- img "Dolomed-Nervenstimulation-Periphere-Illustrator-04-1"
- img "Dolomed-Behandlung-von-chronischen-Ablauf-Illustrator-01-2048x2048"
- img "Dolomed-Bewegungsapparat-arthrose-circles-4"
- heading "Avantages de la neuromodulation" [level=2]
- list:
  - listitem:
    - strong: "Soulagement efficace de la douleur :"
    - text: de nombreux patients font état d'une réduction significative de leur douleur. Cet effet peut être constaté en quelques jours seulement (phase de test). Un réglage fin du système de stimulation prend généralement quelques semaines.
  - listitem:
    - strong: "Amélioration de la qualité de vie :"
    - text: la réduction de la douleur permet aux patients de participer plus activement à la vie.
  - listitem:
    - strong: "Réduction de la consommation de médicaments :"
    - text: De nombreux patients peuvent réduire leur besoin en analgésiques.
- heading "Indications pour l'implantation d'un neurostimulateur pour la stimulation de la moelle épinière ou des nerfs périphériques" [level=2]
- list:
  - listitem: Maux de dos chroniques, surtout après une opération
  - listitem: Syndrome douloureux régional complexe (SDRC) ou maladie de Sudeck
  - listitem: Douleurs neuropathiques
  - listitem: Polyneuropathie diabétique ou autre
  - listitem: Maladie artérielle périphérique pour améliorer la douleur et la microcirculation
- img "Dolomed-Behandlung-Von-Nervenschmerzen-CRPS-Illustrator-01-2-1"
- heading "Comment continuer ?" [level=2]
- text: Vous souffrez de douleurs dorsales ou d’hernies discales ? Découvrez les avantages des infiltrations chez Dolomed. Nos médecins expérimentés se feront un plaisir de vous conseiller sur les différentes options thérapeutiques et d’établir un plan de traitement personnalisé pour vous. Contactez-nous dès aujourd’hui à l’adresse
- link "info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
- text: pour prendre rendez-vous et en savoir plus sur nos options de traitement.
- link "Prendre un rendez-vous":
  - /url: "#"
- heading "Foire aux questions (FAQ)" [level=2]
- button "Quelle est l'efficacité de la neurostimulation sur la douleur ?" [expanded]
- region "Quelle est l'efficacité de la neurostimulation sur la douleur ?":
  - paragraph: Lorsqu’elle est correctement indiquée, la neurostimulation peut être très efficace et offrir un soulagement significatif de la douleur et une amélioration de la qualité de vie.
- button "Qu'est-ce que la technique de neurostimulation ?"
- button "Quelle est la différence entre la neuromodulation et la neurostimulation ?"
- button "Qui pratique la neurostimulation ?"
- button "À qui s'adresse la neurostimulation ?"
- button "Quelle est la durée de vie d'un neurostimulateur ?"
- button "Quel est le danger d'un neurostimulateur ?"
- heading "ZUWEISUNG / BON DE DÉLÉGATION" [level=2]
- paragraph: Centre de compétence pour la médecine de la douleur Centre de compétence pour la médecine de la douleur
- list:
  - listitem: Site Biel / Site Bienne
- list:
  - listitem: Bahnhofplatz 2C / Place de la Gare 2C 2ème étage / Stock, 2502 Biel-Bienne
- list:
  - listitem:
    - img
    - text: Numéro de téléphone
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- list:
  - listitem: Standort Bern / Site de Berne
- list:
  - listitem: Sidlerstrasse 4, 3012 Bern-Berne 2. Stock / 2ème étages, 2502 Bern-Berne
- list:
  - listitem:
    - img
    - text: Numéro de téléphone
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- contentinfo:
  - link "Image link":
    - /url: https://dolomed.ch/
    - img "Image link"
  - paragraph: Suivez nous
  - list:
    - listitem:
      - link:
        - /url: https://www.instagram.com/dolomed.ag
        - img
  - text: Pages
  - link "Accueil":
    - /url: https://dolomed.ch/fr/
  - link "Offre":
    - /url: https://dolomed.ch/fr/#angebot
  - link "Pour les patients et les délégations":
    - /url: https://dolomed.ch/fr/#patienten
  - link "Contact":
    - /url: https://dolomed.ch/fr/#kontakt
  - link "TEAM":
    - /url: https://dolomed.ch/fr/#team
  - link "Carrière":
    - /url: https://dolomed.ch/fr/#karriere
  - text: Maladies
  - link "Appareil locomoteur":
    - /url: /fr/appareil-locomoteur/
  - link "Douleurs d'organes internes":
    - /url: /fr/douleurs-dorganes-internes/
  - link "Maux de tête et douleurs faciales":
    - /url: /fr/maux-de-tete-et-douleurs-faciales/
  - link "Maladies vasculaires":
    - /url: /fr/maladies-vasculaires/
  - link "Traitement des douleurs nerveuses":
    - /url: /fr/traitement-des-douleurs-nerveuses/
  - text: Thérapie
  - link "Stimulation nerveuse":
    - /url: /fr/stimulation-nerveuse/
  - link "Un soulagement naturel grâce à l'acupuncture":
    - /url: fr/soulagement-naturel-par-lacupuncture/
  - link "douleurs chroniques":
    - /url: /fr/douleurs-chroniques/
  - link "Traitement de la douleur chronique":
    - /url: /fr/traitement-des-maladies-chroniques/
  - link "Traitement du mal de dos":
    - /url: /fr/traitement-du-mal-de-dos/
  - link "Plasma (PRP) pour un traitement efficace":
    - /url: /fr/plasma-prp/
  - link "Thérapie par cellules souches":
    - /url: /fr/therapie-par-cellules-souches/
  - link "Thérapie au laser":
    - /url: /fr/therapie-au-laser/
  - link "Thérapie extracorporelle par ondes de choc":
    - /url: /fr/therapie-extracorporelle-par-ondes-de-choc/
  - link "Thérapie par le mouvement et entraînement des fascias":
    - /url: /fr/therapie-par-le-mouvement-et-entrainement-des-fascias/
  - link "Thérapie topique à base de capsaïcine hautement concentrée":
    - /url: /fr/therapie-topique-a-base-de-capsaicine-hautement-concentree/
  - text: Mentions légales
  - link "Mentions légales":
    - /url: /fr/mentions-legales/
  - link "Protection des données":
    - /url: /fr/protection-des-donnees/
  - paragraph: Copyright 2025 – Tous droits réservés Dolomed.
- button
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- heading "Nous aimons toujours discuter avec toi" [level=2]
- text: Parlons
- link "Phone +41 32 324 39 90":
  - /url: tel:+41323243990
  - img "Phone"
  - text: +41 32 324 39 90
- link "Email info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
  - img "Email"
  - text: info@dolomed.ch
- list:
  - listitem:
    - img "list icon"
    - heading "Prendre rendez-vous" [level=3]
  - listitem:
    - link "list icon Support technique":
      - /url: https://dolomed.ch/fr/#kontaktform
      - img "list icon"
      - heading "Support technique" [level=3]
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Envoyer un message à Dolomed Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
- list
- form "Formulaire de contact":
  - paragraph:
    - text: Nom
    - textbox "Nom"
  - paragraph:
    - text: Adresse électronique
    - textbox "Adresse électronique"
  - paragraph:
    - text: Numéro de téléphone
    - textbox "Numéro de téléphone"
  - paragraph:
    - text: Écrivez votre message ci-dessous
    - textbox "Écrivez votre message ci-dessous"
  - paragraph:
    - button "Envoyer"
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Demander à être rappelé Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
- list
- form "Formulaire de contact":
  - paragraph:
    - text: Nom
    - textbox "Nom"
  - paragraph:
    - text: Adresse électronique
    - textbox "Adresse électronique"
  - paragraph:
    - text: Numéro de téléphone
    - textbox "Numéro de téléphone"
  - paragraph:
    - text: Écrivez votre message ci-dessous
    - textbox "Écrivez votre message ci-dessous"
  - paragraph:
    - button "Envoyer"
- link "Go to top":
  - /url: "#"
  - img
- text: tablet
```

# Test source

```ts
   1 | import { test, expect, Page, Browser } from '@playwright/test';
   2 | import { ImageComparison, DiffResult, SizeMismatchTolerance } from './image-diff';
   3 |
   4 | export interface VisualTestConfig {
   5 |   url: string;
   6 |   testName: string;
   7 |   diffThreshold?: number;
   8 |   viewport?: { width: number; height: number };
   9 |   waitForLoadState?: 'load' | 'domcontentloaded' | 'networkidle';
   10 |   customStyles?: string;
   11 |   scrollToBottom?: boolean;
   12 |   waitAfterScroll?: number;
   13 |   sizeMismatchTolerance?: SizeMismatchTolerance;
   14 | }
   15 |
   16 | export class VisualTestHelper {
   17 |   private imageComparison: ImageComparison;
   18 |   private page!: Page;
   19 |   private timestamp: string;
   20 |   private currentUser: string;
   21 |
   22 |   constructor() {
   23 |     this.imageComparison = new ImageComparison();
   24 |     this.timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);
   25 |     this.currentUser = process.env.USER || process.env.USERNAME || 'unknown';
   26 |   }
   27 |
   28 |   async setup(browser: Browser, viewport = { width: 1366, height: 768 }): Promise<void> {
   29 |     const context = await browser.newContext({ viewport });
   30 |     this.page = await context.newPage();
   31 |     console.log(`Test setup initialized at ${this.timestamp} by ${this.currentUser}`);
   32 |   }
   33 |
   34 |   async cleanup(): Promise<void> {
   35 |     if (this.page) {
   36 |       await this.page.close();
   37 |     }
   38 |   }
   39 |
   40 |   async runVisualTest(config: VisualTestConfig): Promise<DiffResult> {
   41 |     const {
   42 |       url,
   43 |       testName,
   44 |       diffThreshold = 0.1,
   45 |       waitForLoadState = 'networkidle',
   46 |       customStyles,
   47 |       scrollToBottom = true,
   48 |       waitAfterScroll = 1000,
   49 |       sizeMismatchTolerance
   50 |     } = config;
   51 |
   52 |     console.log(`Starting visual test at ${this.timestamp}`);
   53 |     console.log(`Test running by user: ${this.currentUser}`);
   54 |     console.log('Page dimensions:', await this.page.viewportSize());
   55 |
   56 |     try {
   57 |       // Navigate to the page
   58 |       await this.page.goto(url);
   59 |       await this.page.waitForLoadState(waitForLoadState);
   60 |
   61 |       // Apply custom styles if provided
   62 |       if (customStyles) {
   63 |         await this.page.addStyleTag({ content: customStyles });
   64 |       }
   65 |
   66 |       // Auto-scroll if enabled
   67 |       if (scrollToBottom) {
   68 |         await this.autoScroll(waitAfterScroll);
   69 |       }
   70 |
   71 |       // Perform image comparison
   72 |       const diffResult = await this.imageComparison.compareScreenshots(
   73 |         this.page, 
   74 |         testName, 
   75 |         diffThreshold, 
   76 |         sizeMismatchTolerance
   77 |       );
   78 |       const reportPath = this.imageComparison.generateDiffReport(testName, diffResult);
   79 |       
   80 |       console.log(`
   81 |         Test Results:
   82 |         - Timestamp: ${this.timestamp}
   83 |         - User: ${this.currentUser}
   84 |         - Report Path: ${reportPath}
   85 |         - Diff Percentage: ${diffResult.diffPercentage.toFixed(2)}%
   86 |       `);
   87 |
   88 |       // Assert the diff percentage
>  89 |       expect(diffResult.diffPercentage).toBeLessThanOrEqual(diffThreshold);
      |                                         ^ Error: expect(received).toBeLessThanOrEqual(expected)
   90 |
   91 |       return diffResult;
   92 |
   93 |     } catch (error) {
   94 |       console.error(`
   95 |         Test failed at ${this.timestamp}
   96 |         User: ${this.currentUser}
   97 |         Error: ${error}
   98 |       `);
   99 |       throw error;
  100 |     }
  101 |   }
  102 |
  103 |   private async autoScroll(waitAfterScroll: number = 1000): Promise<void> {
  104 |     await this.page.evaluate(async () => {
  105 |       await new Promise<void>((resolve) => {
  106 |         let totalHeight = 0;
  107 |         const distance = 100;
  108 |         const timer = setInterval(() => {
  109 |           const scrollHeight = document.documentElement.scrollHeight;
  110 |           window.scrollBy(0, distance);
  111 |           totalHeight += distance;
  112 |
  113 |           if (totalHeight >= scrollHeight) {
  114 |             clearInterval(timer);
  115 |             window.scrollTo(0, scrollHeight);
  116 |             resolve();
  117 |           }
  118 |         }, 240);
  119 |       });
  120 |     });
  121 |
  122 |     await this.page.waitForTimeout(waitAfterScroll);
  123 |   }
  124 |
  125 |   // Getter method for accessing the image comparison instance if needed
  126 |   get imageComparisonInstance(): ImageComparison {
  127 |     return this.imageComparison;
  128 |   }
  129 |
  130 |   // Getter method for accessing the page instance if needed
  131 |   getPage(): Page {
  132 |     return this.page;
  133 |   }
  134 | }
```