# Test info

- Name: Visual Regression - Topische Therapie mit hochkonzentriertem Capsaicin Page (Desktop) >> capsaicin-visual-desktop-fr
- Location: /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/TopischeTherapieMitHochkonzentriertemCapsaicin/TopischeTherapieMitHochkonzentriertemCapsaicinUITest.spec.ts:34:9

# Error details

```
Error: expect(received).toBeLessThanOrEqual(expected)

Expected: <= 0.7
Received:    3.305611063591317
    at VisualTestHelper.runVisualTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/visual-test-helper.ts:89:41)
    at MultiLanguageVisualHelper.runIndividualLanguageTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/multi-language-visual-helper.ts:56:5)
    at /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/TopischeTherapieMitHochkonzentriertemCapsaicin/TopischeTherapieMitHochkonzentriertemCapsaicinUITest.spec.ts:35:7
```

# Page snapshot

```yaml
- heading "🍪 Wir schätzen Ihre Privatsphäre" [level=1]
- paragraph: Wir verwenden Cookies, um Ihr Surferlebnis zu verbessern, personalisierte Anzeigen oder Inhalte einzusetzen und unseren Datenverkehr zu analysieren. Wenn Sie auf „Alle akzeptieren" klicken, stimmen Sie der Anwendung von Cookies zu.
- button "Anpassen"
- button "Alle akzeptieren"
- banner:
  - navigation:
    - link "DOLOMED_Logo_RGB_Claim 1":
      - /url: https://dolomed.ch/fr/
      - img "DOLOMED_Logo_RGB_Claim 1"
    - button "Open/Close Menu":
      - img
    - button "Français":
      - link "Français":
        - /url: "#"
        - img
        - text: Français
- heading "Soulagement efficace de la douleur grâce à la thérapie topique moderne chez Dolomed" [level=1]:
  - text: Soulagement efficace de la douleur grâce à la thérapie topique moderne
  - strong: chez Dolomed
- strong
- strong
- strong:
  - paragraph: La thérapie topique à base de capsaïcine hautement concentrée est une méthode innovante de traitement des douleurs neuropathiques et d'autres douleurs chroniques. La capsaïcine, le principe actif des piments, est appliquée dans une formulation spéciale directement sur la zone cutanée concernée et aide à soulager la douleur de manière ciblée. Chez Dolomed, nous utilisons cette thérapie moderne et bien tolérée pour permettre à nos patients d'améliorer durablement leur qualité de vie.
  - link "Prendre rendez-vous":
    - /url: "#"
  - link "Appeler maintenant":
    - /url: tel:032 324 39 90
- strong
- strong
- strong
- strong:
  - img "Dolomed-Bewegungsapparat-Arthrose-circle-light"
  - img "Dolomed-Bewegungsapparat-arthrose-circles-4"
  - heading "Qu'est-ce que la thérapie topique à la capsaïcine ?" [level=2]
  - text: La thérapie topique utilise la capsaïcine sous une forme hautement concentrée pour traiter spécifiquement les récepteurs de la douleur dans la peau. La capsaïcine agit en désensibilisant les fibres nerveuses responsables de la transmission de la douleur. Cette action est particulièrement efficace dans les douleurs chroniques causées par une hyperactivité des récepteurs de la douleur.
  - list:
    - listitem:
      - strong: "Capsaïcine :"
      - text: substance active naturelle contenue dans les piments, qui cible les récepteurs de la douleur.
    - listitem:
      - strong: "Utilisation par voie topique :"
      - text: Application directe sur la peau, ce qui permet de limiter l'effet localement et de minimiser les effets secondaires systémiques.
  - heading "Possibilités d'utilisation de la thérapie topique à la capsaïcine" [level=2]
  - paragraph: "La thérapie à la capsaïcine est indiquée, entre autres, pour le traitement de :"
  - list:
    - listitem:
      - strong: "Douleurs neuropathiques :"
      - text: soulagement des douleurs dues à l'irritation des nerfs, par exemple en cas de polyneuropathie ou de névralgie post-zostérienne.
    - listitem:
      - strong: "Douleur chez les diabétiques :"
      - text: réduction de la douleur et de la sensation de brûlure dans les pieds causées par la neuropathie diabétique.
  - img "Dolomed-Bewegungsapparat-arthrose-circles-4"
  - heading "Bases théoriques de la thérapie à la capsaïcine" [level=2]
  - paragraph: La capsaïcine agit en activant puis en désensibilisant les récepteurs dits TRPV1 dans les fibres nerveuses. Ces récepteurs sont responsables de la transmission des signaux de douleur au cerveau. Le traitement vise à réduire la sensibilité de ces récepteurs à long terme et à obtenir ainsi un soulagement durable de la douleur.
  - list:
    - listitem:
      - strong: "Activation des récepteurs de la douleur :"
      - text: au début du traitement, les récepteurs TRPV1 sont stimulés.
    - listitem:
      - strong: "Désensibilisation :"
      - text: la stimulation répétée rend les récepteurs moins sensibles, ce qui entraîne une réduction de la sensation de douleur.
    - listitem:
      - strong: "Effet à long terme :"
      - text: un seul traitement peut être efficace pendant des semaines ou des mois.
  - heading "Déroulement de la thérapie à la capsaïcine chez Dolomed" [level=2]
  - paragraph: "La thérapie topique à la capsaïcine est réalisée sous supervision professionnelle et comprend les étapes suivantes :"
  - list:
    - listitem:
      - strong: "1. premier entretien et diagnostic :"
      - text: identifier la cause de la douleur et déterminer si la thérapie à la capsaïcine est appropriée. En outre, demande de garantie de prise en charge auprès de la caisse d'assurance maladie.
    - listitem:
      - strong: "2. préparation de la peau :"
      - text: nettoyage et préparation de la zone à traiter.
    - listitem:
      - strong: "3. application de la capsaïcine hautement concentrée :"
      - text: application d'un patch ou d'une crème spéciale sur la zone cutanée concernée. L'application se fait généralement pendant 30 à 60 minutes.
    - listitem:
      - strong: "4. suivi :"
      - text: surveillance de la progression du traitement et rendez-vous de contrôle réguliers pour évaluer les effets.
  - img "Dolomed-Bewegungsapparat-arthrose-circles-4"
  - heading "Avantages de la thérapie topique à la capsaïcine" [level=2]
  - paragraph: "La thérapie à la capsaïcine présente de nombreux avantages pour les patients souffrant de douleurs chroniques :"
  - list:
    - listitem:
      - strong: "Action ciblée :"
      - text: traitement direct de la région affectée sans effets secondaires systémiques.
    - listitem:
      - strong: "Soulagement de la douleur à long terme :"
      - text: une seule application peut être efficace pendant plusieurs semaines, voire plusieurs mois.
    - listitem:
      - strong: "Bien toléré :"
      - text: le traitement est sûr et bien toléré, avec un minimum d'effets secondaires.
    - listitem:
      - strong: "Simple à mettre en œuvre :"
      - text: Le traitement est non invasif et ne nécessite pas de longues périodes d'arrêt.
    - listitem:
      - strong: "Thérapie complémentaire :"
      - text: peut être efficacement combinée avec d'autres thérapies de la douleur.
  - heading "Comment continuer ?" [level=2]
  - text: Vous souhaitez soulager vos douleurs de manière ciblée et durable ? La thérapie topique à base de capsaïcine hautement concentrée chez Dolomed vous offre une solution moderne et efficace. Contactez-nous dès aujourd’hui à l’adresse
  - link "info@dolomed.ch":
    - /url: mailto:info@dolomed.ch
  - text: pour prendre rendez-vous et vous informer sur les avantages de cette méthode de traitement innovante.
  - link "Prendre un rendez-vous":
    - /url: "#"
  - heading "Foire aux questions (FAQ)" [level=2]
  - button "La thérapie à la capsaïcine est-elle douloureuse ?" [expanded]
  - region "La thérapie à la capsaïcine est-elle douloureuse ?":
    - paragraph: Une sensation temporaire de chaleur ou de brûlure peut être ressentie pendant le traitement, mais elle est généralement bien tolérée.
  - button "Quelle est la durée d'action d'une application ?"
  - button "Quels sont les effets secondaires ?"
  - button "À qui s'adresse cette thérapie ?"
  - button "Combien de traitements sont nécessaires ?"
  - button "La caisse d'assurance maladie prend-elle en charge les coûts ?"
  - paragraph: Avec la thérapie topique à la capsaïcine hautement concentrée chez Dolomed, nous vous proposons une méthode ciblée et durable pour soulager la douleur. Découvrez les avantages de ce traitement moderne et prenez rendez-vous dès maintenant !
  - heading "ZUWEISUNG / BON DE DÉLÉGATION" [level=2]
  - paragraph: Centre de compétence pour la médecine de la douleur Centre de compétence pour la médecine de la douleur
  - list:
    - listitem: Site Biel / Site Bienne
  - list:
    - listitem: Bahnhofplatz 2C / Place de la Gare 2C 2ème étage / Stock, 2502 Biel-Bienne
  - list:
    - listitem:
      - img
      - text: Numéro de téléphone
  - list:
    - listitem:
      - link "+41 32 324 39 90":
        - /url: tel:+41%2032%20324%2039%2090
  - list:
    - listitem:
      - img
      - text: E-mail
  - list:
    - listitem:
      - link "info@dolomed.ch":
        - /url: mailto:info@dolomed.ch
  - list:
    - listitem: Standort Bern / Site de Berne
  - list:
    - listitem: Sidlerstrasse 4, 3012 Bern-Berne 2. Stock / 2ème étages, 2502 Bern-Berne
  - list:
    - listitem:
      - img
      - text: Numéro de téléphone
  - list:
    - listitem:
      - link "+41 32 324 39 90":
        - /url: tel:+41%2032%20324%2039%2090
  - list:
    - listitem:
      - img
      - text: E-mail
  - list:
    - listitem:
      - link "info@dolomed.ch":
        - /url: mailto:info@dolomed.ch
- strong:
  - contentinfo:
    - link "Image link":
      - /url: https://dolomed.ch/
      - img "Image link"
    - paragraph: Suivez nous
    - list:
      - listitem:
        - link:
          - /url: https://www.instagram.com/dolomed.ag
          - img
    - text: Pages
    - link "Accueil":
      - /url: https://dolomed.ch/fr/
    - link "Offre":
      - /url: https://dolomed.ch/fr/#angebot
    - link "Pour les patients et les délégations":
      - /url: https://dolomed.ch/fr/#patienten
    - link "Contact":
      - /url: https://dolomed.ch/fr/#kontakt
    - link "TEAM":
      - /url: https://dolomed.ch/fr/#team
    - link "Carrière":
      - /url: https://dolomed.ch/fr/#karriere
    - text: Maladies
    - link "Appareil locomoteur":
      - /url: /fr/appareil-locomoteur/
    - link "Douleurs d'organes internes":
      - /url: /fr/douleurs-dorganes-internes/
    - link "Maux de tête et douleurs faciales":
      - /url: /fr/maux-de-tete-et-douleurs-faciales/
    - link "Maladies vasculaires":
      - /url: /fr/maladies-vasculaires/
    - link "Traitement des douleurs nerveuses":
      - /url: /fr/traitement-des-douleurs-nerveuses/
    - text: Thérapie
    - link "Stimulation nerveuse":
      - /url: /fr/stimulation-nerveuse/
    - link "Un soulagement naturel grâce à l'acupuncture":
      - /url: fr/soulagement-naturel-par-lacupuncture/
    - link "douleurs chroniques":
      - /url: /fr/douleurs-chroniques/
    - link "Traitement de la douleur chronique":
      - /url: /fr/traitement-des-maladies-chroniques/
    - link "Traitement du mal de dos":
      - /url: /fr/traitement-du-mal-de-dos/
    - link "Plasma (PRP) pour un traitement efficace":
      - /url: /fr/plasma-prp/
    - link "Thérapie par cellules souches":
      - /url: /fr/therapie-par-cellules-souches/
    - link "Thérapie au laser":
      - /url: /fr/therapie-au-laser/
    - link "Thérapie extracorporelle par ondes de choc":
      - /url: /fr/therapie-extracorporelle-par-ondes-de-choc/
    - link "Thérapie par le mouvement et entraînement des fascias":
      - /url: /fr/therapie-par-le-mouvement-et-entrainement-des-fascias/
    - link "Thérapie topique à base de capsaïcine hautement concentrée":
      - /url: /fr/therapie-topique-a-base-de-capsaicine-hautement-concentree/
    - text: Mentions légales
    - link "Mentions légales":
      - /url: /fr/mentions-legales/
    - link "Protection des données":
      - /url: /fr/protection-des-donnees/
    - paragraph: Copyright 2025 – Tous droits réservés Dolomed.
- strong:
  - button
  - button "retour":
    - img
    - text: retour
  - button "Close contact slide button":
    - img "Close"
    - text: contact slide button
  - heading "Nous aimons toujours discuter avec toi" [level=2]
  - text: Parlons
  - link "Phone +41 32 324 39 90":
    - /url: tel:+41323243990
    - img "Phone"
    - text: +41 32 324 39 90
  - link "Email info@dolomed.ch":
    - /url: mailto:info@dolomed.ch
    - img "Email"
    - text: info@dolomed.ch
  - list:
    - listitem:
      - img "list icon"
      - heading "Prendre rendez-vous" [level=3]
    - listitem:
      - link "list icon Support technique":
        - /url: https://dolomed.ch/fr/#kontaktform
        - img "list icon"
        - heading "Support technique" [level=3]
  - button "retour":
    - img
    - text: retour
  - button "Close contact slide button":
    - img "Close"
    - text: contact slide button
  - text: Envoyer un message à Dolomed Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
  - list
  - form "Formulaire de contact":
    - paragraph:
      - text: Nom
      - textbox "Nom"
    - paragraph:
      - text: Adresse électronique
      - textbox "Adresse électronique"
    - paragraph:
      - text: Numéro de téléphone
      - textbox "Numéro de téléphone"
    - paragraph:
      - text: Écrivez votre message ci-dessous
      - textbox "Écrivez votre message ci-dessous"
    - paragraph:
      - button "Envoyer"
  - button "retour":
    - img
    - text: retour
  - button "Close contact slide button":
    - img "Close"
    - text: contact slide button
  - text: Demander à être rappelé Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
  - list
  - form "Formulaire de contact":
    - paragraph:
      - text: Nom
      - textbox "Nom"
    - paragraph:
      - text: Adresse électronique
      - textbox "Adresse électronique"
    - paragraph:
      - text: Numéro de téléphone
      - textbox "Numéro de téléphone"
    - paragraph:
      - text: Écrivez votre message ci-dessous
      - textbox "Écrivez votre message ci-dessous"
    - paragraph:
      - button "Envoyer"
  - link "Go to top":
    - /url: "#"
    - img
- text: tablet
```

# Test source

```ts
   1 | import { test, expect, Page, Browser } from '@playwright/test';
   2 | import { ImageComparison, DiffResult, SizeMismatchTolerance } from './image-diff';
   3 |
   4 | export interface VisualTestConfig {
   5 |   url: string;
   6 |   testName: string;
   7 |   diffThreshold?: number;
   8 |   viewport?: { width: number; height: number };
   9 |   waitForLoadState?: 'load' | 'domcontentloaded' | 'networkidle';
   10 |   customStyles?: string;
   11 |   scrollToBottom?: boolean;
   12 |   waitAfterScroll?: number;
   13 |   sizeMismatchTolerance?: SizeMismatchTolerance;
   14 | }
   15 |
   16 | export class VisualTestHelper {
   17 |   private imageComparison: ImageComparison;
   18 |   private page!: Page;
   19 |   private timestamp: string;
   20 |   private currentUser: string;
   21 |
   22 |   constructor() {
   23 |     this.imageComparison = new ImageComparison();
   24 |     this.timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);
   25 |     this.currentUser = process.env.USER || process.env.USERNAME || 'unknown';
   26 |   }
   27 |
   28 |   async setup(browser: Browser, viewport = { width: 1366, height: 768 }): Promise<void> {
   29 |     const context = await browser.newContext({ viewport });
   30 |     this.page = await context.newPage();
   31 |     console.log(`Test setup initialized at ${this.timestamp} by ${this.currentUser}`);
   32 |   }
   33 |
   34 |   async cleanup(): Promise<void> {
   35 |     if (this.page) {
   36 |       await this.page.close();
   37 |     }
   38 |   }
   39 |
   40 |   async runVisualTest(config: VisualTestConfig): Promise<DiffResult> {
   41 |     const {
   42 |       url,
   43 |       testName,
   44 |       diffThreshold = 0.1,
   45 |       waitForLoadState = 'networkidle',
   46 |       customStyles,
   47 |       scrollToBottom = true,
   48 |       waitAfterScroll = 1000,
   49 |       sizeMismatchTolerance
   50 |     } = config;
   51 |
   52 |     console.log(`Starting visual test at ${this.timestamp}`);
   53 |     console.log(`Test running by user: ${this.currentUser}`);
   54 |     console.log('Page dimensions:', await this.page.viewportSize());
   55 |
   56 |     try {
   57 |       // Navigate to the page
   58 |       await this.page.goto(url);
   59 |       await this.page.waitForLoadState(waitForLoadState);
   60 |
   61 |       // Apply custom styles if provided
   62 |       if (customStyles) {
   63 |         await this.page.addStyleTag({ content: customStyles });
   64 |       }
   65 |
   66 |       // Auto-scroll if enabled
   67 |       if (scrollToBottom) {
   68 |         await this.autoScroll(waitAfterScroll);
   69 |       }
   70 |
   71 |       // Perform image comparison
   72 |       const diffResult = await this.imageComparison.compareScreenshots(
   73 |         this.page, 
   74 |         testName, 
   75 |         diffThreshold, 
   76 |         sizeMismatchTolerance
   77 |       );
   78 |       const reportPath = this.imageComparison.generateDiffReport(testName, diffResult);
   79 |       
   80 |       console.log(`
   81 |         Test Results:
   82 |         - Timestamp: ${this.timestamp}
   83 |         - User: ${this.currentUser}
   84 |         - Report Path: ${reportPath}
   85 |         - Diff Percentage: ${diffResult.diffPercentage.toFixed(2)}%
   86 |       `);
   87 |
   88 |       // Assert the diff percentage
>  89 |       expect(diffResult.diffPercentage).toBeLessThanOrEqual(diffThreshold);
      |                                         ^ Error: expect(received).toBeLessThanOrEqual(expected)
   90 |
   91 |       return diffResult;
   92 |
   93 |     } catch (error) {
   94 |       console.error(`
   95 |         Test failed at ${this.timestamp}
   96 |         User: ${this.currentUser}
   97 |         Error: ${error}
   98 |       `);
   99 |       throw error;
  100 |     }
  101 |   }
  102 |
  103 |   private async autoScroll(waitAfterScroll: number = 1000): Promise<void> {
  104 |     await this.page.evaluate(async () => {
  105 |       await new Promise<void>((resolve) => {
  106 |         let totalHeight = 0;
  107 |         const distance = 100;
  108 |         const timer = setInterval(() => {
  109 |           const scrollHeight = document.documentElement.scrollHeight;
  110 |           window.scrollBy(0, distance);
  111 |           totalHeight += distance;
  112 |
  113 |           if (totalHeight >= scrollHeight) {
  114 |             clearInterval(timer);
  115 |             window.scrollTo(0, scrollHeight);
  116 |             resolve();
  117 |           }
  118 |         }, 240);
  119 |       });
  120 |     });
  121 |
  122 |     await this.page.waitForTimeout(waitAfterScroll);
  123 |   }
  124 |
  125 |   // Getter method for accessing the image comparison instance if needed
  126 |   get imageComparisonInstance(): ImageComparison {
  127 |     return this.imageComparison;
  128 |   }
  129 |
  130 |   // Getter method for accessing the page instance if needed
  131 |   getPage(): Page {
  132 |     return this.page;
  133 |   }
  134 | }
```