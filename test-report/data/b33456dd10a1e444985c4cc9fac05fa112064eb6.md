# Test info

- Name: Visual Regression - Stammzellentherapie Page (Mobile) >> stammzellentherapie-visual-mobile-fr
- Location: /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/Stammzellentherapie/StammzellentherapieUITest.spec.ts:64:9

# Error details

```
Error: expect(received).toBeLessThanOrEqual(expected)

Expected: <= 0.7
Received:    7.711247244965515
    at VisualTestHelper.runVisualTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/visual-test-helper.ts:89:41)
    at MultiLanguageVisualHelper.runIndividualLanguageTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/multi-language-visual-helper.ts:56:5)
    at /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/Stammzellentherapie/StammzellentherapieUITest.spec.ts:65:7
```

# Page snapshot

```yaml
- heading "🍪 Wir schätzen Ihre Privatsphäre" [level=1]
- paragraph: Wir verwenden Cookies, um Ihr Surferlebnis zu verbessern, personalisierte Anzeigen oder Inhalte einzusetzen und unseren Datenverkehr zu analysieren. Wenn Sie auf „Alle akzeptieren" klicken, stimmen Sie der Anwendung von Cookies zu.
- button "Anpassen"
- button "Alle akzeptieren"
- banner:
  - navigation:
    - link "DOLOMED_Logo_RGB_Claim 1":
      - /url: https://dolomed.ch/fr/
      - img "DOLOMED_Logo_RGB_Claim 1"
    - button "Open/Close Menu":
      - img
    - button "Français":
      - link "Français":
        - /url: "#"
        - img
        - text: Français
- heading "Thérapie par cellules souches" [level=1]
- 'heading "Méthodes de guérison modernes avec la thérapie par cellules souches : des options de traitement efficaces chez Dolomed" [level=2]'
- paragraph: La thérapie par cellules souches est une méthode de traitement innovante et avant-gardiste qui utilise les processus de régénération de l'organisme pour traiter différentes maladies. Chez Dolomed, nos principaux spécialistes utilisent la thérapie par cellules souches à partir de la fraction stomavasculaire (tissu adipeux) pour offrir à nos patients un traitement efficace et sûr.
- link "Prendre rendez-vous":
  - /url: "#"
- link "Appeler maintenant":
  - /url: tel:032 324 39 90
- img "Dolomed-Bewegungsapparat-Arthrose-circle-light"
- heading "Qu'est-ce que la thérapie par cellules souches ?" [level=2]
- paragraph: La thérapie par cellules souches utilise les propres cellules souches de l'organisme pour réparer les tissus endommagés et favoriser la guérison. Ces cellules souches sont prélevées dans le tissu adipeux du patient, puis traitées afin d'obtenir une solution concentrée riche en cellules régénératrices. Cette forme de thérapie est de plus en plus populaire en Suisse et dans le monde et offre de nombreuses possibilités d'utilisation.
- list:
  - listitem:
    - strong: "Les cellules souches :"
    - text: Cellules endogènes ayant la capacité de se transformer en différents types de cellules et de réparer les tissus endommagés.
  - listitem:
    - strong: "SVF (Stromal Vascular Fraction) :"
    - text: Un mélange concentré de cellules souches et de facteurs de croissance prélevés dans le tissu adipeux.
- heading "Possibilités d'utilisation de la thérapie par cellules souches" [level=2]
- paragraph: La thérapie par cellules souches peut être utilisée pour traiter une grande variété de maladies et de blessures, notamment
- list:
  - listitem:
    - strong: "Arthrose :"
    - text: traitement de l'arthrose articulaire, notamment du genou et de la hanche, pour réduire la douleur et améliorer la fonction articulaire.
  - listitem:
    - strong: "Blessures sportives :"
    - text: Accélération de la guérison des blessures musculaires, tendineuses et ligamentaires.
  - listitem:
    - strong: "Maladies orthopédiques :"
    - text: Traitement des douleurs dorsales chroniques et des maladies dégénératives de la colonne vertébrale, mais aussi au niveau des articulations périphériques.
  - listitem:
    - strong: "Traumatologie :"
    - text: aide à la guérison après un accident ou une opération.
- heading "Bases théoriques de la thérapie par cellules souches" [level=2]
- paragraph: Les cellules souches ont la capacité unique de se différencier en différents types de cellules et de régénérer les tissus endommagés. Dans le cadre de la thérapie SVF, ces cellules sont extraites du tissu adipeux du patient, préparées dans une centrifugeuse, puis injectées dans la zone affectée. La combinaison de facteurs de croissance et de cytokines dans le SVF favorise la guérison et réduit l'inflammation. En règle générale, il n'y a pas de véritable formation de nouveau cartilage, par exemple. Les cellules souches injectées modifient les conditions environnementales dans l'articulation (pH, protéases acides) et contribuent ainsi au soulagement de la douleur et à la régénération des structures environnantes.
- list:
  - listitem:
    - strong: "Obtention :"
    - text: les cellules souches sont obtenues par une liposuccion peu invasive. Celle-ci n'est pas pertinente d'un point de vue cosmétique. En parallèle, du sang est prélevé pour obtenir du plasma riche en plaquettes (PRP) contenant des facteurs de croissance enrichis.
  - listitem:
    - strong: "Préparation :"
    - text: les cellules et le PRP sont concentrés et préparés dans une centrifugeuse spéciale.
  - listitem:
    - strong: "Injection :"
    - text: les cellules souches préparées sont mélangées au PRP et injectées dans la zone affectée afin de favoriser la guérison.
- heading "Déroulement de la thérapie par cellules souches chez Dolomed" [level=2]
- paragraph: "Une thérapie par cellules souches typique chez Dolomed comprend plusieurs étapes :"
- list:
  - listitem:
    - strong: "Premier entretien et diagnostic :"
    - text: anamnèse détaillée et imagerie médicale pour un diagnostic précis.
  - listitem:
    - strong: "Prélèvement, préparation et injection des cellules souches (un rendez-vous au bloc opératoire) :"
    - text: Prélèvement de tissu adipeux sous anesthésie locale ou sédation. Concentration des cellules souches dans une centrifugeuse. Injection des cellules souches dans la structure concernée.
  - listitem:
    - strong: "Suivi :"
    - text: rendez-vous de contrôle réguliers pour surveiller le processus de guérison.
- img "Dolomed-Bewegungsapparat-Spastik-Illustration-02"
- heading "Avantages de la thérapie par cellules souches" [level=2]
- paragraph: "La thérapie par cellules souches présente de nombreux avantages pour les patients souffrant de divers troubles :"
- list:
  - listitem:
    - strong: "Guérison naturelle :"
    - text: utilisation des propres cellules du corps pour favoriser la guérison.
  - listitem:
    - strong: "Mini-invasive :"
    - text: méthode douce avec peu de contraintes pour le patient.
  - listitem:
    - strong: "Résultats durables :"
    - text: En cas de traitement réussi, réduction de la gêne pendant parfois plusieurs années.
  - listitem:
    - strong: "Utilisation polyvalente :"
    - text: efficace pour une grande variété de maladies et de blessures.
- heading "Comment continuer ?" [level=2]
- img "Dolomed-Bewegungsapparat-Wieweiter-Illustration-02"
- text: Vous êtes intéressé par la thérapie par cellules souches et souhaitez obtenir plus d’informations sur ce domaine ? Découvrez les avantages de ce traitement innovant chez Dolomed. Nos médecins expérimentés se feront un plaisir de vous conseiller sur les indications et les possibilités de la thérapie par cellules souches et de créer un plan de traitement personnalisé pour vous. Contactez-nous dès aujourd’hui à l’adresse
- link "info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
- text: pour prendre rendez-vous et en savoir plus sur nos options thérapeutiques.
- link "Prendre un rendez-vous":
  - /url: "#"
- img "faq-dots-bg-img"
- heading "Foire aux questions (FAQ)" [level=2]
- button "La thérapie par cellules souches est-elle autorisée en Suisse ?" [expanded]
- region "La thérapie par cellules souches est-elle autorisée en Suisse ?": Oui, la thérapie par cellules souches est autorisée en Suisse et est pratiquée dans des conditions légales strictes afin de garantir la sécurité des patients.
- button "Quels sont les risques liés à la thérapie par cellules souches ?"
- button "Comment fonctionne la thérapie par cellules souches ?"
- button "Quelles maladies peuvent être traitées par les cellules souches ?"
- button "Le coût de la thérapie par cellules souches est-il pris en charge par l'assurance maladie ?"
- button "Combien coûte une thérapie par cellules souches ?"
- button "Qui peut effectuer un traitement par cellules souches ?"
- button "Combien de temps dure la régénération après une thérapie par cellules souches ?"
- heading "ZUWEISUNG / BON DE DÉLÉGATION" [level=2]
- paragraph: Centre de compétence pour la médecine de la douleur Centre de compétence pour la médecine de la douleur
- list:
  - listitem: Site Biel / Site Bienne
- list:
  - listitem: Bahnhofplatz 2C / Place de la Gare 2C 2ème étage / Stock, 2502 Biel-Bienne
- list:
  - listitem:
    - img
    - text: Numéro de téléphone
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- list:
  - listitem: Standort Bern / Site de Berne
- list:
  - listitem: Sidlerstrasse 4, 3012 Bern-Berne 2. Stock / 2ème étages, 2502 Bern-Berne
- list:
  - listitem:
    - img
    - text: Numéro de téléphone
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- contentinfo:
  - link "Image link":
    - /url: https://dolomed.ch/
    - img "Image link"
  - text: Pages
  - link "Accueil":
    - /url: https://dolomed.ch/fr/
  - link "Offre":
    - /url: https://dolomed.ch/fr/#angebot
  - link "Pour les patients et les délégations":
    - /url: https://dolomed.ch/fr/#patienten
  - link "Contact":
    - /url: https://dolomed.ch/fr/#kontakt
  - link "TEAM":
    - /url: https://dolomed.ch/fr/#team
  - link "Carrière":
    - /url: https://dolomed.ch/fr/#karriere
  - text: Maladies
  - link "Appareil locomoteur":
    - /url: /fr/appareil-locomoteur/
  - link "Douleurs d'organes internes":
    - /url: /fr/douleurs-dorganes-internes/
  - link "Maux de tête et douleurs faciales":
    - /url: /fr/maux-de-tete-et-douleurs-faciales/
  - link "Maladies vasculaires":
    - /url: /fr/maladies-vasculaires/
  - link "Traitement des douleurs nerveuses":
    - /url: /fr/traitement-des-douleurs-nerveuses/
  - text: Thérapie
  - link "Stimulation nerveuse":
    - /url: /fr/stimulation-nerveuse/
  - link "Un soulagement naturel grâce à l'acupuncture":
    - /url: fr/soulagement-naturel-par-lacupuncture/
  - link "douleurs chroniques":
    - /url: /fr/douleurs-chroniques/
  - link "Traitement de la douleur chronique":
    - /url: /fr/traitement-des-maladies-chroniques/
  - link "Traitement du mal de dos":
    - /url: /fr/traitement-du-mal-de-dos/
  - link "Plasma (PRP) pour un traitement efficace":
    - /url: /fr/plasma-prp/
  - link "Thérapie par cellules souches":
    - /url: /fr/therapie-par-cellules-souches/
  - link "Thérapie au laser":
    - /url: /fr/therapie-au-laser/
  - link "Thérapie extracorporelle par ondes de choc":
    - /url: /fr/therapie-extracorporelle-par-ondes-de-choc/
  - link "Thérapie par le mouvement et entraînement des fascias":
    - /url: /fr/therapie-par-le-mouvement-et-entrainement-des-fascias/
  - link "Thérapie topique à base de capsaïcine hautement concentrée":
    - /url: /fr/therapie-topique-a-base-de-capsaicine-hautement-concentree/
  - text: Mentions légales
  - link "Mentions légales":
    - /url: /fr/mentions-legales/
  - link "Protection des données":
    - /url: /fr/protection-des-donnees/
  - text: Suivez nous
  - list:
    - listitem:
      - link:
        - /url: https://www.instagram.com/dolomed.ag
        - img
  - paragraph: Copyright 2025 – Tous droits réservés Dolomed.
- button
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- heading "Nous aimons toujours discuter avec toi" [level=2]
- text: Parlons
- link "Phone +41 32 324 39 90":
  - /url: tel:+41323243990
  - img "Phone"
  - text: +41 32 324 39 90
- link "Email info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
  - img "Email"
  - text: info@dolomed.ch
- list:
  - listitem:
    - img "list icon"
    - heading "Prendre rendez-vous" [level=3]
  - listitem:
    - link "list icon Support technique":
      - /url: https://dolomed.ch/fr/#kontaktform
      - img "list icon"
      - heading "Support technique" [level=3]
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Envoyer un message à Dolomed Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
- list
- form "Formulaire de contact":
  - paragraph:
    - text: Nom
    - textbox "Nom"
  - paragraph:
    - text: Adresse électronique
    - textbox "Adresse électronique"
  - paragraph:
    - text: Numéro de téléphone
    - textbox "Numéro de téléphone"
  - paragraph:
    - text: Écrivez votre message ci-dessous
    - textbox "Écrivez votre message ci-dessous"
  - paragraph:
    - button "Envoyer"
- button "retour":
  - img
  - text: retour
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Demander à être rappelé Si vous avez des questions ou des préoccupations, veuillez nous contacter. Des réponses rapides et une aide sont garanties.
- list
- form "Formulaire de contact":
  - paragraph:
    - text: Nom
    - textbox "Nom"
  - paragraph:
    - text: Adresse électronique
    - textbox "Adresse électronique"
  - paragraph:
    - text: Numéro de téléphone
    - textbox "Numéro de téléphone"
  - paragraph:
    - text: Écrivez votre message ci-dessous
    - textbox "Écrivez votre message ci-dessous"
  - paragraph:
    - button "Envoyer"
- link "Go to top":
  - /url: "#"
  - img
- text: mobile
```

# Test source

```ts
   1 | import { test, expect, Page, Browser } from '@playwright/test';
   2 | import { ImageComparison, DiffResult, SizeMismatchTolerance } from './image-diff';
   3 |
   4 | export interface VisualTestConfig {
   5 |   url: string;
   6 |   testName: string;
   7 |   diffThreshold?: number;
   8 |   viewport?: { width: number; height: number };
   9 |   waitForLoadState?: 'load' | 'domcontentloaded' | 'networkidle';
   10 |   customStyles?: string;
   11 |   scrollToBottom?: boolean;
   12 |   waitAfterScroll?: number;
   13 |   sizeMismatchTolerance?: SizeMismatchTolerance;
   14 | }
   15 |
   16 | export class VisualTestHelper {
   17 |   private imageComparison: ImageComparison;
   18 |   private page!: Page;
   19 |   private timestamp: string;
   20 |   private currentUser: string;
   21 |
   22 |   constructor() {
   23 |     this.imageComparison = new ImageComparison();
   24 |     this.timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);
   25 |     this.currentUser = process.env.USER || process.env.USERNAME || 'unknown';
   26 |   }
   27 |
   28 |   async setup(browser: Browser, viewport = { width: 1366, height: 768 }): Promise<void> {
   29 |     const context = await browser.newContext({ viewport });
   30 |     this.page = await context.newPage();
   31 |     console.log(`Test setup initialized at ${this.timestamp} by ${this.currentUser}`);
   32 |   }
   33 |
   34 |   async cleanup(): Promise<void> {
   35 |     if (this.page) {
   36 |       await this.page.close();
   37 |     }
   38 |   }
   39 |
   40 |   async runVisualTest(config: VisualTestConfig): Promise<DiffResult> {
   41 |     const {
   42 |       url,
   43 |       testName,
   44 |       diffThreshold = 0.1,
   45 |       waitForLoadState = 'networkidle',
   46 |       customStyles,
   47 |       scrollToBottom = true,
   48 |       waitAfterScroll = 1000,
   49 |       sizeMismatchTolerance
   50 |     } = config;
   51 |
   52 |     console.log(`Starting visual test at ${this.timestamp}`);
   53 |     console.log(`Test running by user: ${this.currentUser}`);
   54 |     console.log('Page dimensions:', await this.page.viewportSize());
   55 |
   56 |     try {
   57 |       // Navigate to the page
   58 |       await this.page.goto(url);
   59 |       await this.page.waitForLoadState(waitForLoadState);
   60 |
   61 |       // Apply custom styles if provided
   62 |       if (customStyles) {
   63 |         await this.page.addStyleTag({ content: customStyles });
   64 |       }
   65 |
   66 |       // Auto-scroll if enabled
   67 |       if (scrollToBottom) {
   68 |         await this.autoScroll(waitAfterScroll);
   69 |       }
   70 |
   71 |       // Perform image comparison
   72 |       const diffResult = await this.imageComparison.compareScreenshots(
   73 |         this.page, 
   74 |         testName, 
   75 |         diffThreshold, 
   76 |         sizeMismatchTolerance
   77 |       );
   78 |       const reportPath = this.imageComparison.generateDiffReport(testName, diffResult);
   79 |       
   80 |       console.log(`
   81 |         Test Results:
   82 |         - Timestamp: ${this.timestamp}
   83 |         - User: ${this.currentUser}
   84 |         - Report Path: ${reportPath}
   85 |         - Diff Percentage: ${diffResult.diffPercentage.toFixed(2)}%
   86 |       `);
   87 |
   88 |       // Assert the diff percentage
>  89 |       expect(diffResult.diffPercentage).toBeLessThanOrEqual(diffThreshold);
      |                                         ^ Error: expect(received).toBeLessThanOrEqual(expected)
   90 |
   91 |       return diffResult;
   92 |
   93 |     } catch (error) {
   94 |       console.error(`
   95 |         Test failed at ${this.timestamp}
   96 |         User: ${this.currentUser}
   97 |         Error: ${error}
   98 |       `);
   99 |       throw error;
  100 |     }
  101 |   }
  102 |
  103 |   private async autoScroll(waitAfterScroll: number = 1000): Promise<void> {
  104 |     await this.page.evaluate(async () => {
  105 |       await new Promise<void>((resolve) => {
  106 |         let totalHeight = 0;
  107 |         const distance = 100;
  108 |         const timer = setInterval(() => {
  109 |           const scrollHeight = document.documentElement.scrollHeight;
  110 |           window.scrollBy(0, distance);
  111 |           totalHeight += distance;
  112 |
  113 |           if (totalHeight >= scrollHeight) {
  114 |             clearInterval(timer);
  115 |             window.scrollTo(0, scrollHeight);
  116 |             resolve();
  117 |           }
  118 |         }, 240);
  119 |       });
  120 |     });
  121 |
  122 |     await this.page.waitForTimeout(waitAfterScroll);
  123 |   }
  124 |
  125 |   // Getter method for accessing the image comparison instance if needed
  126 |   get imageComparisonInstance(): ImageComparison {
  127 |     return this.imageComparison;
  128 |   }
  129 |
  130 |   // Getter method for accessing the page instance if needed
  131 |   getPage(): Page {
  132 |     return this.page;
  133 |   }
  134 | }
```