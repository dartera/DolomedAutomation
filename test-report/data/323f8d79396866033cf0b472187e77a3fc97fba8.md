# Test info

- Name: Visual Regression - Gefaesserkrankungen Page (Desktop) >> gefaesserkrankungen-visual-desktop-de
- Location: /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/gefaesserkrankungen/GefaesserkrankungenUITest.spec.ts:34:9

# Error details

```
Error: expect(received).toBeLessThanOrEqual(expected)

Expected: <= 0.7
Received:    4.217598333487855
    at VisualTestHelper.runVisualTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/visual-test-helper.ts:89:41)
    at MultiLanguageVisualHelper.runIndividualLanguageTest (/Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/utils/multi-language-visual-helper.ts:56:5)
    at /Users/b.enukidze/Documents/Dartera/Test/DolomedAutomation/src/tests/gefaesserkrankungen/GefaesserkrankungenUITest.spec.ts:35:7
```

# Page snapshot

```yaml
- heading "🍪 Wir schätzen Ihre Privatsphäre" [level=1]
- paragraph: Wir verwenden Cookies, um Ihr Surferlebnis zu verbessern, personalisierte Anzeigen oder Inhalte einzusetzen und unseren Datenverkehr zu analysieren. Wenn Sie auf „Alle akzeptieren" klicken, stimmen Sie der Anwendung von Cookies zu.
- button "Anpassen"
- button "Alle akzeptieren"
- banner:
  - navigation:
    - link "DOLOMED_Logo_RGB_Claim 1":
      - /url: /
      - img "DOLOMED_Logo_RGB_Claim 1"
    - button "Open/Close Menu":
      - img
    - button "Deutsch":
      - link "Deutsch":
        - /url: "#"
        - img
        - text: Deutsch
- heading "Schmerzen bei Gefässerkrankungen" [level=1]:
  - text: Schmerzen bei
  - strong: Gefässerkrankungen
- 'heading "Umfassende Therapieansätze für Schmerzen bei Gefässerkrankungen: Effektive Behandlungsmöglichkeiten bei Dolomed" [level=2]'
- paragraph: Schmerzen bei Gefässerkrankungen können die Lebensqualität erheblich beeinträchtigen und sind oft schwer zu behandeln. Bei Dolomed bieten wir eine breite Palette an Therapiemöglichkeiten an, um diese Schmerzen zu lindern und die Gesundheit unserer Patienten zu verbessern. Unsere ganzheitlichen Ansätze umfassen modernste Techniken wie TENS, Ketamin-Infusionen, Infiltrationen und Neurostimulation.
- link "Termin vereinbaren":
  - /url: "#"
- link "Jetzt anrufen":
  - /url: tel:032 324 39 90
- img "Dolomed-Gesichtsschmerzen-Hero-Illustrator-01"
- img "Dolomed-Bewegungsapparat-Arthrose-circle-light"
- img "Dolomed-Gesichtsschmerzen-Periphere-Illustrator-01-3"
- img "Dolomed-Bewegungsapparat-arthrose-circles-4"
- heading "Was sind Schmerzen bei Gefässerkrankungen?" [level=2]
- paragraph: Schmerzen bei Gefässerkrankungen entstehen durch verminderte Durchblutung aufgrund von Verengungen oder Verschlüssen in den Blutgefäßen. Dies kann zu einer Vielzahl von Symptomen führen, einschließlich Schmerzen, Taubheitsgefühl und Schwäche in den betroffenen Bereichen.
- heading "Periphere arterielle Verschlusskrankheit (PAVK)" [level=2]
- paragraph: Die periphere arterielle Verschlusskrankheit ist eine chronische Erkrankung, bei der die Arterien, die die Gliedmaßen mit Blut versorgen, verengt oder blockiert sind. Dies führt zu Schmerzen, insbesondere beim Gehen, und kann im fortgeschrittenen Stadium zu Ruheschmerzen und Gewebeverlust führen. Oft werden die Patienten bereits durch Kollegen der Angiologie oder Gefässchirurgie betreut. Dolomed kann eine zusätzliche Unterstützung sein.
- heading "Therapieoptionen bei Dolomed:" [level=3]
- list:
  - listitem:
    - strong: "Ketamin-Infusionen:"
    - text: Effektive Schmerzlinderung bei therapierefraktären Fällen.
  - listitem:
    - strong: "Neurostimulation:"
    - text: Stimulation der Nerven, um Schmerzsignale zu blockieren und die Heilung zu fördern. Auch die Mikrodurchblutung kann durch die zentrale Neurostimulation verbessert werden.
  - listitem:
    - strong: "Infiltrationen:"
    - text: Injektionen zur gezielten Schmerzlinderung und Reduktion von Entzündungen.
- img "Dolomed-Chronischen-schmerzen-Was-Illustrator-01-2"
- img "Dolomed-Gesichtsschmerzen-Angina-Illustrator-01"
- img "Dolomed-Bewegungsapparat-arthrose-circles-4"
- heading "Angina Pectoris" [level=2]
- paragraph: Angina Pectoris ist ein Symptom der koronaren Herzkrankheit, das durch Brustschmerzen oder -druck aufgrund einer verminderten Durchblutung des Herzmuskels gekennzeichnet ist. Die akute Angina pectoris stellt als Hinweis auf einen akuten Herzinfarkt einen Notfall dar, deshalb sollte in diesem Fall die Ambulanz gerufen werden.
- heading "Therapieoptionen bei Dolomed:" [level=3]
- list:
  - listitem:
    - strong: "Neurostimulation:"
    - text: Blockierung der Schmerzsignale und Verbesserung der Durchblutung.
- heading "Wie weiter?" [level=2]
- img "Dolomed-Bewegungsapparat-Wieweiter-Illustration-02"
- text: Leiden Sie unter Rückenschmerzen oder sonstigen Schmerzen im Bewegungsapparat? Vereinbaren Sie noch heute einen Termin bei Dolomed und lassen Sie sich von unseren Experten beraten. Kontaktieren Sie uns unter
- link "info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
- text: ", um mehr über unsere individuellen Behandlungsoptionen zu erfahren. Bitte beachten Sie, dass für die Behandlung eine Zuweisung erforderlich ist."
- link "Einen Termin vereinbaren":
  - /url: "#"
- heading "Häufig gestellte Fragen (FAQ)" [level=2]
- button "Was sind die häufigsten Ursachen für Kopfschmerzen?" [expanded]
- region "Was sind die häufigsten Ursachen für Kopfschmerzen?":
  - paragraph: Kopfschmerzen können durch eine Vielzahl von Faktoren verursacht werden, darunter Migräne, Spannungskopfschmerzen, Clusterkopfschmerzen, postpunktionelle Kopfschmerzen und Trigeminusneuralgie.
- button "Welche Behandlungen bieten Sie Betroffenen bei Dolomed an?"
- button "Wie wirkt TENS?"
- button "Was ist Sphenocath und wie funktioniert es?"
- button "Was ist Neuromodulation?"
- button "Was sind Infiltrationen bestimmter Nerven und Muskeln?"
- button "Wie kann ich einen Termin vereinbaren?"
- button "Was tun gegen Kopfschmerzen oben auf dem Kopf?"
- heading "ZUWEISUNG / BON DE DÉLÉGATION" [level=2]
- paragraph: Kompetenzzentrum für Schmerzmedizin Centre de compétence pour la médecine de la douleur
- list:
  - listitem: Standort Biel / Site Bienne
- list:
  - listitem: Bahnhofplatz 2C / Place de la Gare 2C 2. Stock / 2ème étage, 2502 Biel-Bienne
- list:
  - listitem:
    - img
    - text: Telefonnummer
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-Mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- list:
  - listitem: Standort Bern / Site de Berne
- list:
  - listitem: Sidlerstrasse 4, 3012 Bern-Berne 2. Stock / 2ème étages, 2502 Bern-Berne
- list:
  - listitem:
    - img
    - text: Telefonnummer
- list:
  - listitem:
    - link "+41 32 324 39 90":
      - /url: tel:+41%2032%20324%2039%2090
- list:
  - listitem:
    - img
    - text: E-Mail
- list:
  - listitem:
    - link "info@dolomed.ch":
      - /url: mailto:info@dolomed.ch
- contentinfo:
  - link "Image link":
    - /url: https://dolomed.ch/
    - img "Image link"
  - paragraph: Folgen Sie uns
  - list:
    - listitem:
      - link:
        - /url: https://www.instagram.com/dolomed.ag
        - img
  - text: Seiten
  - link "Startseite":
    - /url: https://dolomed.ch/
  - link "Angebot":
    - /url: https://dolomed.ch///#angebot
  - link "Für Patienten und Zuweiser":
    - /url: https://dolomed.ch//#patienten
  - link "Kontakt":
    - /url: https://dolomed.ch//#kontakt
  - link "Team":
    - /url: https://dolomed.ch/#team
  - link "Karriere":
    - /url: https://dolomed.ch//#karriere
  - text: Krankheiten
  - link "Bewegungsapparat":
    - /url: /bewegungsapparat/
  - link "Schmerzen Innerer organe":
    - /url: https://dolomed.ch/schmerzen-innerer-organe/
  - link "kopfschmerzen und gesichtsschmerzen":
    - /url: https://dolomed.ch/kopfschmerzen-und-gesichtsschmerzen/
  - link "gefaesserkrankungen":
    - /url: https://dolomed.ch/gefaesserkrankungen/
  - link "behandlung von nervenschmerzen":
    - /url: https://dolomed.ch/behandlung-von-nervenschmerzen/
  - text: Therapie
  - link "nervenstimulation":
    - /url: https://dolomed.ch/nervenstimulation/
  - link "natuerliche linderung durch akupunktur":
    - /url: https://dolomed.ch/natuerliche-linderung-durch-akupunktur/
  - link "chronischen schmerzen":
    - /url: https://dolomed.ch/chronischen-schmerzen/
  - link "behandlung von chronischen":
    - /url: https://dolomed.ch/behandlung-von-chronischen/
  - link "behandlung von rueckenschmerzen":
    - /url: https://dolomed.ch/behandlung-von-rueckenschmerzen/
  - link "plasma prp":
    - /url: https://dolomed.ch/plasma-prp/
  - link "stammzellentherapie":
    - /url: https://dolomed.ch/stammzellentherapie/
  - link "Lasertherapie":
    - /url: /lasertherapie/
  - link "Extrakorporale Stoßwellentherapie":
    - /url: /extrakorporale-stosswellentherapie/
  - link "Bewegungstherapie und Faszientraining":
    - /url: /bewegungstherapie-und-faszientraining/
  - link "Topische Therapie mit hochkonzentriertem Capsaicin":
    - /url: /topische-therapie-mit-hochkonzentriertem-capsaicin/
  - text: Rechtliches
  - link "Impressum":
    - /url: /impressum
  - link "Datenschutz":
    - /url: /datenschutz
  - paragraph: Copyright 2025 – Alle Rechte vorbehalten Dolomed.
- button
- button:
  - img
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- heading "Wir freuen uns immer mit Ihnen zu sprechen." [level=2]
- text: Unterhalten wir uns
- link "Phone +41 32 324 39 90":
  - /url: tel:+41323243990
  - img "Phone"
  - text: +41 32 324 39 90
- link "Email info@dolomed.ch":
  - /url: mailto:info@dolomed.ch
  - img "Email"
  - text: info@dolomed.ch
- text: Wir sind Mo-Fr von 8-18 Uhr kostenlos für Sie erreichbar.
- list:
  - listitem:
    - img "list icon"
    - heading "Termin vereinbaren" [level=3]
  - listitem:
    - link "list icon Kontaktseite öffnen":
      - /url: https://dolomed.ch/#kontaktform
      - img "list icon"
      - heading "Kontaktseite öffnen" [level=3]
- button:
  - img
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Senden Sie eine Nachricht an Dolomed Bei Fragen oder Anliegen wenden Sie sich bitte an uns. Schnelle Antworten und Hilfe sind garantiert.
- list
- form "Kontaktformular":
  - paragraph:
    - text: Name
    - textbox "Name"
  - paragraph:
    - text: E-Mail-Adresse
    - textbox "E-Mail-Adresse"
  - paragraph:
    - text: Telefonnummer
    - textbox "Telefonnummer"
  - paragraph:
    - text: Schreiben Sie unten Ihre Nachricht
    - textbox "Schreiben Sie unten Ihre Nachricht"
  - paragraph:
    - button "Senden"
- button:
  - img
- button "Close contact slide button":
  - img "Close"
  - text: contact slide button
- text: Rückruf anfordern Bei Fragen oder Anliegen wenden Sie sich bitte an uns. Schnelle Antworten und Hilfe sind garantiert.
- list
- form "Kontaktformular":
  - paragraph:
    - text: Name
    - textbox "Name"
  - paragraph:
    - text: E-Mail-Adresse
    - textbox "E-Mail-Adresse"
  - paragraph:
    - text: Telefonnummer
    - textbox "Telefonnummer"
  - paragraph:
    - text: Schreiben Sie unten Ihre Nachricht
    - textbox "Schreiben Sie unten Ihre Nachricht"
  - paragraph:
    - button "Senden"
- link "Go to top":
  - /url: "#"
  - img
- text: tablet
```

# Test source

```ts
   1 | import { test, expect, Page, Browser } from '@playwright/test';
   2 | import { ImageComparison, DiffResult, SizeMismatchTolerance } from './image-diff';
   3 |
   4 | export interface VisualTestConfig {
   5 |   url: string;
   6 |   testName: string;
   7 |   diffThreshold?: number;
   8 |   viewport?: { width: number; height: number };
   9 |   waitForLoadState?: 'load' | 'domcontentloaded' | 'networkidle';
   10 |   customStyles?: string;
   11 |   scrollToBottom?: boolean;
   12 |   waitAfterScroll?: number;
   13 |   sizeMismatchTolerance?: SizeMismatchTolerance;
   14 | }
   15 |
   16 | export class VisualTestHelper {
   17 |   private imageComparison: ImageComparison;
   18 |   private page!: Page;
   19 |   private timestamp: string;
   20 |   private currentUser: string;
   21 |
   22 |   constructor() {
   23 |     this.imageComparison = new ImageComparison();
   24 |     this.timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);
   25 |     this.currentUser = process.env.USER || process.env.USERNAME || 'unknown';
   26 |   }
   27 |
   28 |   async setup(browser: Browser, viewport = { width: 1366, height: 768 }): Promise<void> {
   29 |     const context = await browser.newContext({ viewport });
   30 |     this.page = await context.newPage();
   31 |     console.log(`Test setup initialized at ${this.timestamp} by ${this.currentUser}`);
   32 |   }
   33 |
   34 |   async cleanup(): Promise<void> {
   35 |     if (this.page) {
   36 |       await this.page.close();
   37 |     }
   38 |   }
   39 |
   40 |   async runVisualTest(config: VisualTestConfig): Promise<DiffResult> {
   41 |     const {
   42 |       url,
   43 |       testName,
   44 |       diffThreshold = 0.1,
   45 |       waitForLoadState = 'networkidle',
   46 |       customStyles,
   47 |       scrollToBottom = true,
   48 |       waitAfterScroll = 1000,
   49 |       sizeMismatchTolerance
   50 |     } = config;
   51 |
   52 |     console.log(`Starting visual test at ${this.timestamp}`);
   53 |     console.log(`Test running by user: ${this.currentUser}`);
   54 |     console.log('Page dimensions:', await this.page.viewportSize());
   55 |
   56 |     try {
   57 |       // Navigate to the page
   58 |       await this.page.goto(url);
   59 |       await this.page.waitForLoadState(waitForLoadState);
   60 |
   61 |       // Apply custom styles if provided
   62 |       if (customStyles) {
   63 |         await this.page.addStyleTag({ content: customStyles });
   64 |       }
   65 |
   66 |       // Auto-scroll if enabled
   67 |       if (scrollToBottom) {
   68 |         await this.autoScroll(waitAfterScroll);
   69 |       }
   70 |
   71 |       // Perform image comparison
   72 |       const diffResult = await this.imageComparison.compareScreenshots(
   73 |         this.page, 
   74 |         testName, 
   75 |         diffThreshold, 
   76 |         sizeMismatchTolerance
   77 |       );
   78 |       const reportPath = this.imageComparison.generateDiffReport(testName, diffResult);
   79 |       
   80 |       console.log(`
   81 |         Test Results:
   82 |         - Timestamp: ${this.timestamp}
   83 |         - User: ${this.currentUser}
   84 |         - Report Path: ${reportPath}
   85 |         - Diff Percentage: ${diffResult.diffPercentage.toFixed(2)}%
   86 |       `);
   87 |
   88 |       // Assert the diff percentage
>  89 |       expect(diffResult.diffPercentage).toBeLessThanOrEqual(diffThreshold);
      |                                         ^ Error: expect(received).toBeLessThanOrEqual(expected)
   90 |
   91 |       return diffResult;
   92 |
   93 |     } catch (error) {
   94 |       console.error(`
   95 |         Test failed at ${this.timestamp}
   96 |         User: ${this.currentUser}
   97 |         Error: ${error}
   98 |       `);
   99 |       throw error;
  100 |     }
  101 |   }
  102 |
  103 |   private async autoScroll(waitAfterScroll: number = 1000): Promise<void> {
  104 |     await this.page.evaluate(async () => {
  105 |       await new Promise<void>((resolve) => {
  106 |         let totalHeight = 0;
  107 |         const distance = 100;
  108 |         const timer = setInterval(() => {
  109 |           const scrollHeight = document.documentElement.scrollHeight;
  110 |           window.scrollBy(0, distance);
  111 |           totalHeight += distance;
  112 |
  113 |           if (totalHeight >= scrollHeight) {
  114 |             clearInterval(timer);
  115 |             window.scrollTo(0, scrollHeight);
  116 |             resolve();
  117 |           }
  118 |         }, 240);
  119 |       });
  120 |     });
  121 |
  122 |     await this.page.waitForTimeout(waitAfterScroll);
  123 |   }
  124 |
  125 |   // Getter method for accessing the image comparison instance if needed
  126 |   get imageComparisonInstance(): ImageComparison {
  127 |     return this.imageComparison;
  128 |   }
  129 |
  130 |   // Getter method for accessing the page instance if needed
  131 |   getPage(): Page {
  132 |     return this.page;
  133 |   }
  134 | }
```